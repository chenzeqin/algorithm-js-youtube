# [leetcode 417. 太平洋大西洋水流问题](https://leetcode.cn/problems/pacific-atlantic-water-flow/)

给定一个 `m x n` 的高度矩阵 `heights`。水从一个格子可以流向上下左右四个方向中高度小于或等于当前格子的格子。左边界与上边界相邻的是太平洋，右边界与下边界相邻的是大西洋。求既能流到太平洋又能流到大西洋的所有坐标。

![太平洋大西洋水流问题](../../assets/图-waterflow-grid.jpg)

## 思路精讲（逆向思维 + 图搜索）

- 正向想：从每个格子往外流，看能否抵达两大洋，代价高，需要为每个起点做搜索。
- 逆向想（关键）：从两大洋的海岸线出发，向内「逆流而上」。因为水能从高处流到低处或相等处，所以逆向只允许从低到高/相等地走。这样从海岸线能到达的格子，正向就能把水流到对应大洋。
- 分别从两条海岸线做搜索：
  - 太平洋：上边界 `r=0` 和左边界 `c=0`
  - 大西洋：下边界 `r=m-1` 和右边界 `c=n-1`
- 得到两个可达矩阵 `pacificVisited` 和 `atlanticVisited`，它们的交集就是答案坐标。

可用 DFS 或 BFS 实现；这里用 DFS，写法简洁。

## 实现

<<< @/09-图/9.3-太平洋大西洋水流问题/太平洋大西洋水流问题.js

## 复杂度分析

- 设矩阵为 `m x n`。
- 时间复杂度：`O(m*n)`，每个格子最多被每个大洋搜索访问一次。
- 空间复杂度：`O(m*n)`，主要是两个 `visited` 矩阵与递归栈（最坏 `O(m*n)`）。

## 小结与易错点

- 逆向从海岸线「只走到不矮于当前高度」是关键条件：`heights[next] >= heights[cur]`。
- 边界初始化要覆盖整条边：行和列两条边都要遍历作为起点。
